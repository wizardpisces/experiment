## Introduction
mini [bullmq](https://github.com/taskforcesh/bullmq)

## 难点
### RPC 通信
解决的是 Broker 与 Producer 以及 Consumer 之间的通信问题。

### 高可用设计
高可用主要涉及两方面：Broker 服务的高可用、存储方案的高可用。

### 存储设计

### 消费关系管理

### 高性能设计

## 纵向(Scale-up) 横向扩展(Scale-out)

两个比喻:

　　一是传统火车和动车。传统的存储Scale-up架构的存储就好像传统的火车一样，当后面的磁盘越挂越多的时候，控制器性能以及背板带宽却不能相应提升，因此传统存储在磁盘容量扩容到一定程度时候，往往性能下降。

　　集群存储就好像新一代的“动车组”火车一样，当火车车厢增加的时候，前面的火车头动力也随之增加，因此不会发生性能瓶颈。

　　所谓动车组的设计理念和传统火车设计理念的最大区别在于传统火车主要动力来自于火车头(就像传统模块化阵列的两个控制器)，而动车组则不一样，除了车头配有动力装置外，每一节车厢都配有动力推动装置。集群存储大多都是由一个个节点(X86 服务器)组成，每一个节点添加进去后，不仅能够添加容量，还能够添加整个存储器的整体处理能力。

一个鱼缸的比喻：

　　当你只有六七条鱼的时候， 一个小型鱼缸就够了;可是过一段时间新生了三十多条小鱼，这个小缸显然不够大了。

　　如果用Scale up解决方案，那么你就需要去买一个大缸，把所有沙、水草、布景、加热棒、温度计都从小缸里拿出来，重新布置到大缸。这个工程可不简单哦，不是十分钟八分钟能搞得定的，尤其水草，纠在一起很难分开(不过这跟迁移数据的工程复杂度比起来实在是毛毛雨啦，不值一提)。

　　那么现在换个思路，用Scale out方案，就相当于是你在这个小缸旁边接了一个同样的小缸，两个缸联通。鱼可以自动分散到两个缸，你也就省掉了上面提到的那一系列挪沙、水草、布景等的折腾了。

## Reference

* https://www.zhihu.com/question/54152397
* https://zhuanlan.zhihu.com/p/77920331